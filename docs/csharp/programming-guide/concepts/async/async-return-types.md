---
title: 비동기 반환 형식(C#)
description: 각 형식 및 추가 리소스에 대한 코드 예제를 통해 C#에서 비동기 메서드의 가능한 반환 형식에 대해 알아봅니다.
ms.date: 08/19/2020
ms.assetid: ddb2539c-c898-48c1-ad92-245e4a996df8
ms.openlocfilehash: 53eb3bedebb99cd829101eee4c2e190c0fb952bf
ms.sourcegitcommit: 1dbe25ff484a02025d5c34146e517c236f7161fb
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/19/2021
ms.locfileid: "104653454"
---
# <a name="async-return-types-c"></a><span data-ttu-id="918a0-103">비동기 반환 형식(C#)</span><span class="sxs-lookup"><span data-stu-id="918a0-103">Async return types (C#)</span></span>

<span data-ttu-id="918a0-104">비동기 메서드의 반환 형식은 다음과 같을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-104">Async methods can have the following return types:</span></span>

- <span data-ttu-id="918a0-105"><xref:System.Threading.Tasks.Task> - 작업을 수행하지만 아무 값도 반환하지 않는 비동기 메서드의 경우</span><span class="sxs-lookup"><span data-stu-id="918a0-105"><xref:System.Threading.Tasks.Task>, for an async method that performs an operation but returns no value.</span></span>
- <span data-ttu-id="918a0-106"><xref:System.Threading.Tasks.Task%601> - 값을 반환하는 비동기 메서드의 경우</span><span class="sxs-lookup"><span data-stu-id="918a0-106"><xref:System.Threading.Tasks.Task%601>, for an async method that returns a value.</span></span>
- <span data-ttu-id="918a0-107">`void` - 이벤트 처리기의 경우</span><span class="sxs-lookup"><span data-stu-id="918a0-107">`void`, for an event handler.</span></span>
- <span data-ttu-id="918a0-108">C# 7.0부터 액세스 가능한 `GetAwaiter` 메서드가 있는 모든 형식.</span><span class="sxs-lookup"><span data-stu-id="918a0-108">Starting with C# 7.0, any type that has an accessible `GetAwaiter` method.</span></span> <span data-ttu-id="918a0-109">`GetAwaiter` 메서드에서 반환된 개체는 <xref:System.Runtime.CompilerServices.ICriticalNotifyCompletion?displayProperty=nameWithType> 인터페이스를 구현해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-109">The object returned by the `GetAwaiter` method must implement the <xref:System.Runtime.CompilerServices.ICriticalNotifyCompletion?displayProperty=nameWithType> interface.</span></span>
- <span data-ttu-id="918a0-110">C# 8.0부터 ‘비동기 스트림’을 반환하는 비동기 메서드의 경우 <xref:System.Collections.Generic.IAsyncEnumerable%601>.</span><span class="sxs-lookup"><span data-stu-id="918a0-110">Starting with C# 8.0, <xref:System.Collections.Generic.IAsyncEnumerable%601>, for an async method that returns an *async stream*.</span></span>

<span data-ttu-id="918a0-111">비동기 메서드에 관한 자세한 내용은 [async 및 await를 사용한 비동기 프로그래밍(C#)](./index.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="918a0-111">For more information about async methods, see [Asynchronous programming with async and await (C#)](./index.md).</span></span>

<span data-ttu-id="918a0-112">Windows 워크로드와 관련된 몇 가지 다른 형식도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-112">Several other types also exist that are specific to Windows workloads:</span></span>

- <span data-ttu-id="918a0-113"><xref:System.Windows.Threading.DispatcherOperation> - Windows로 제한된 비동기 작업에 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-113"><xref:System.Windows.Threading.DispatcherOperation>, for async operations limited to Windows.</span></span>
- <span data-ttu-id="918a0-114"><xref:Windows.Foundation.IAsyncAction> - 값을 반환하지 않는 UWP의 비동기 작업에 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-114"><xref:Windows.Foundation.IAsyncAction>, for async actions in UWP that do not return a value.</span></span>
- <span data-ttu-id="918a0-115"><xref:Windows.Foundation.IAsyncActionWithProgress%601> - 진행률을 보고하지만 값을 반환하지 않는 UWP의 비동기 작업에 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-115"><xref:Windows.Foundation.IAsyncActionWithProgress%601>, for async actions in UWP that report progress but do not return a value.</span></span>
- <span data-ttu-id="918a0-116"><xref:Windows.Foundation.IAsyncOperation%601> - 값을 반환하는 UWP의 비동기 작업에 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-116"><xref:Windows.Foundation.IAsyncOperation%601>, for async operations in UWP that return a value.</span></span>
- <span data-ttu-id="918a0-117"><xref:Windows.Foundation.IAsyncOperationWithProgress%602> - 진행률을 보고하고 값을 반환하는 UWP의 비동기 작업에 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-117"><xref:Windows.Foundation.IAsyncOperationWithProgress%602>, for async operations in UWP that report progress and return a value.</span></span>

## <a name="task-return-type"></a><span data-ttu-id="918a0-118">Task 반환 형식</span><span class="sxs-lookup"><span data-stu-id="918a0-118">Task return type</span></span>

<span data-ttu-id="918a0-119">`return` 문을 포함하지 않거나 피연산자를 반환하지 않는 `return` 문을 포함하는 비동기 메서드의 반환 형식은 일반적으로 <xref:System.Threading.Tasks.Task>입니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-119">Async methods that don't contain a `return` statement or that contain a `return` statement that doesn't return an operand usually have a return type of <xref:System.Threading.Tasks.Task>.</span></span> <span data-ttu-id="918a0-120">이러한 메서드는 동기적으로 실행될 경우 `void`를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-120">Such methods return `void` if they run synchronously.</span></span> <span data-ttu-id="918a0-121">비동기 메서드에 대해 <xref:System.Threading.Tasks.Task> 반환 형식을 사용하는 경우 호출된 비동기 메서드가 완료될 때까지 호출 메서드는 `await` 연산자를 사용하여 호출자의 완료를 일시 중단할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-121">If you use a <xref:System.Threading.Tasks.Task> return type for an async method, a calling method can use an `await` operator to suspend the caller's completion until the called async method has finished.</span></span>

<span data-ttu-id="918a0-122">다음 예제에서 `WaitAndApologizeAsync` 메서드에는 `return` 문이 없으므로 메서드가 <xref:System.Threading.Tasks.Task> 개체를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-122">In the following example, the `WaitAndApologizeAsync` method doesn't contain a `return` statement, so the method returns a <xref:System.Threading.Tasks.Task> object.</span></span> <span data-ttu-id="918a0-123">`Task`를 반환하면 `WaitAndApologizeAsync`가 대기할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-123">Returning a `Task` enables `WaitAndApologizeAsync` to be awaited.</span></span> <span data-ttu-id="918a0-124"><xref:System.Threading.Tasks.Task> 형식에는 반환 값이 없으므로 `Result` 속성이 포함되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-124">The <xref:System.Threading.Tasks.Task> type doesn't include a `Result` property because it has no return value.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns2.cs" id="TaskReturn":::

<span data-ttu-id="918a0-125">동기 void를 반환하는 메서드에 대한 호출 문과 비슷하게 await 식 대신 await 문을 사용하여 `WaitAndApologizeAsync`가 대기됩니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-125">`WaitAndApologizeAsync` is awaited by using an await statement instead of an await expression, similar to the calling statement for a synchronous void-returning method.</span></span> <span data-ttu-id="918a0-126">이 경우 await 연산자를 적용하면 값이 산출되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-126">The application of an await operator in this case doesn't produce a value.</span></span> <span data-ttu-id="918a0-127">`await`의 오른쪽 피연산자가 <xref:System.Threading.Tasks.Task%601>인 경우 `await` 식의 결과는 `T`입니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-127">When the right operand of an `await` is a <xref:System.Threading.Tasks.Task%601>, the `await` expression produces a result of `T`.</span></span> <span data-ttu-id="918a0-128">`await`의 오른쪽 피연산자가 <xref:System.Threading.Tasks.Task>인 경우 `await` 및 해당 피연산자는 문입니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-128">When the right operand of an `await` is a <xref:System.Threading.Tasks.Task>, the `await` and its operand are a statement.</span></span>

<span data-ttu-id="918a0-129">다음 코드와 같이 `WaitAndApologizeAsync` 호출을 await 연산자의 적용과 구분할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-129">You can separate the call to `WaitAndApologizeAsync` from the application of an await operator, as the following code shows.</span></span> <span data-ttu-id="918a0-130">그러나 `Task`에는 `Result` 속성이 없으므로 await 연산자가 `Task`에 적용될 때 값이 생성되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-130">However, remember that a `Task` doesn't have a `Result` property, and that no value is produced when an await operator is applied to a `Task`.</span></span>

<span data-ttu-id="918a0-131">다음 코드에서는 `WaitAndApologizeAsync` 메서드 호출과 해당 메서드에서 반환하는 작업 대기를 구분합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-131">The following code separates calling the `WaitAndApologizeAsync` method from awaiting the task that the method returns.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns2a.cs" id="AwaitTask":::

## <a name="tasktresult-return-type"></a><span data-ttu-id="918a0-132">Task\<TResult\> 반환 형식</span><span class="sxs-lookup"><span data-stu-id="918a0-132">Task\<TResult\> return type</span></span>

<span data-ttu-id="918a0-133"><xref:System.Threading.Tasks.Task%601> 반환 형식은 피연산자가 `TResult`인 [return](../../../language-reference/keywords/return.md) 문이 포함된 비동기 메서드에 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-133">The <xref:System.Threading.Tasks.Task%601> return type is used for an async method that contains a [return](../../../language-reference/keywords/return.md) statement in which the operand is `TResult`.</span></span>

<span data-ttu-id="918a0-134">다음 예제에서 `GetLeisureHoursAsync` 메서드는 정수를 반환하는 `return` 문을 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-134">In the following example, the `GetLeisureHoursAsync` method contains a `return` statement that returns an integer.</span></span> <span data-ttu-id="918a0-135">따라서 메서드 선언은 `Task<int>`의 반환 형식을 지정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-135">Therefore, the method declaration must specify a return type of `Task<int>`.</span></span> <span data-ttu-id="918a0-136"><xref:System.Threading.Tasks.Task.FromResult%2A> 비동기 메서드는 <xref:System.DateTime.DayOfWeek>를 반환하는 작업의 자리 표시자입니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-136">The <xref:System.Threading.Tasks.Task.FromResult%2A> async method is a placeholder for an operation that returns a <xref:System.DateTime.DayOfWeek>.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns1.cs" id="LeisureHours":::

<span data-ttu-id="918a0-137">`ShowTodaysInfo` 메서드의 await 식 내에서 `GetLeisureHoursAsync`를 호출하면 await 식이 `GetLeisureHours`에서 반환된 작업에 저장된 정수 값(`leisureHours` 값)을 검색합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-137">When `GetLeisureHoursAsync` is called from within an await expression in the `ShowTodaysInfo` method, the await expression retrieves the integer value (the value of `leisureHours`) that's stored in the task returned by the `GetLeisureHours` method.</span></span> <span data-ttu-id="918a0-138">await 식에 대한 자세한 내용은 [await](../../../language-reference/operators/await.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="918a0-138">For more information about await expressions, see [await](../../../language-reference/operators/await.md).</span></span>

<span data-ttu-id="918a0-139">다음 코드와 같이 `GetLeisureHoursAsync` 호출을 `await` 적용과 구분하면 `await`가 `Task<T>`에서 결과를 검색하는 방법을 더욱 잘 이해할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-139">You can better understand how `await` retrieves the result from a `Task<T>` by separating the call to `GetLeisureHoursAsync` from the application of `await`, as the following code shows.</span></span> <span data-ttu-id="918a0-140">곧바로 대기 상태가 되지 않는 `GetLeisureHoursAsync` 메서드를 호출하면 메서드 선언에서 예상한 대로 `Task<int>`를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-140">A call to method `GetLeisureHoursAsync` that isn't immediately awaited returns a `Task<int>`, as you would expect from the declaration of the method.</span></span> <span data-ttu-id="918a0-141">예제에서 작업이 `getLeisureHoursTask` 변수에 할당됩니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-141">The task is assigned to the `getLeisureHoursTask` variable in the example.</span></span> <span data-ttu-id="918a0-142">`getLeisureHoursTask`가 <xref:System.Threading.Tasks.Task%601>이기 때문에 `TResult` 형식의 <xref:System.Threading.Tasks.Task%601.Result> 속성을 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-142">Because `getLeisureHoursTask` is a <xref:System.Threading.Tasks.Task%601>, it contains a <xref:System.Threading.Tasks.Task%601.Result> property of type `TResult`.</span></span> <span data-ttu-id="918a0-143">이 경우 `TResult`는 정수 형식을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-143">In this case, `TResult` represents an integer type.</span></span> <span data-ttu-id="918a0-144">`await`가 `getLeisureHoursTask`에 적용되는 경우 await 식은 `getLeisureHoursTask`의 <xref:System.Threading.Tasks.Task%601.Result%2A> 속성 내용으로 평가됩니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-144">When `await` is applied to `getLeisureHoursTask`, the await expression evaluates to the contents of the <xref:System.Threading.Tasks.Task%601.Result%2A> property of `getLeisureHoursTask`.</span></span> <span data-ttu-id="918a0-145">값은 `ret` 변수에 할당됩니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-145">The value is assigned to the `ret` variable.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="918a0-146"><xref:System.Threading.Tasks.Task%601.Result%2A> 속성은 차단 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-146">The <xref:System.Threading.Tasks.Task%601.Result%2A> property is a blocking property.</span></span> <span data-ttu-id="918a0-147">해당 작업이 완료되기 전에 액세스하려고 하면, 작업이 완료되고 값을 사용할 수 있을 때까지 현재 활성화된 스레드가 차단됩니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-147">If you try to access it before its task is finished, the thread that's currently active is blocked until the task completes and the value is available.</span></span> <span data-ttu-id="918a0-148">대부분의 경우 속성에 직접 액세스하지 않고 `await`를 사용하여 값에 액세스해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-148">In most cases, you should access the value by using `await` instead of accessing the property directly.</span></span>
>
> <span data-ttu-id="918a0-149">이전 예제에서는 `Main` 메서드가 애플리케이션 종료 전에 `message`를 콘솔에 인쇄할 수 있도록 <xref:System.Threading.Tasks.Task%601.Result%2A> 속성의 값을 검색하여 주 스레드를 차단했습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-149">The previous example retrieved the value of the <xref:System.Threading.Tasks.Task%601.Result%2A> property to block the main thread so that the `Main` method could print the `message` to the console before the application ended.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns1a.cs" id="StoreTask":::

## <a name="void-return-type"></a><span data-ttu-id="918a0-150">Void 반환 형식</span><span class="sxs-lookup"><span data-stu-id="918a0-150">Void return type</span></span>

<span data-ttu-id="918a0-151">`void`반환 형식이 필요한 비동기 이벤트 처리기에 `void` 반환 형식을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-151">You use the `void` return type in asynchronous event handlers, which require a `void` return type.</span></span> <span data-ttu-id="918a0-152">값을 반환하지 않는 이벤트 처리기 이외의 메서드의 경우 `void`를 반환하는 비동기 메서드를 대기할 수 없기 때문에 <xref:System.Threading.Tasks.Task>를 대신 반환해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-152">For methods other than event handlers that don't return a value, you should return a <xref:System.Threading.Tasks.Task> instead, because an async method that returns `void` can't be awaited.</span></span> <span data-ttu-id="918a0-153">해당 메서드의 호출자는 호출된 비동기 메서드가 마치는 것을 기다리지 않고 완료될 때까지 계속 진행해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-153">Any caller of such a method must continue to completion without waiting for the called async method to finish.</span></span> <span data-ttu-id="918a0-154">호출자는 비동기 메서드가 생성하는 모든 값 또는 예외와 독립되어 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-154">The caller must be independent of any values or exceptions that the async method generates.</span></span>

<span data-ttu-id="918a0-155">Void를 반환하는 비동기 메서드의 호출자는 메서드에서 throw되는 예외를 catch할 수 없으므로 처리되지 않은 예외를 사용하면 애플리케이션이 실패할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-155">The caller of a void-returning async method can't catch exceptions thrown from the method, and such unhandled exceptions are likely to cause your application to fail.</span></span> <span data-ttu-id="918a0-156"><xref:System.Threading.Tasks.Task> 또는 <xref:System.Threading.Tasks.Task%601>를 반환하는 메서드가 예외를 throw하는 경우 이 예외는 반환된 작업에 저장됩니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-156">If a method that returns a <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601> throws an exception, the exception is stored in the returned task.</span></span> <span data-ttu-id="918a0-157">작업이 대기하는 경우 예외가 다시 throw됩니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-157">The exception is rethrown when the task is awaited.</span></span> <span data-ttu-id="918a0-158">따라서 예외를 생성할 수 있는 모든 비동기 메서드에 <xref:System.Threading.Tasks.Task> 또는 <xref:System.Threading.Tasks.Task%601>의 반환 형식이 있고 메서드 호출이 대기 상태인지 확인해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-158">Therefore, make sure that any async method that can produce an exception has a return type of <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601> and that calls to the method are awaited.</span></span>

<span data-ttu-id="918a0-159">비동기 메서드에서 예외를 catch하는 방법에 관한 자세한 내용은 [try-catch](../../../language-reference/keywords/try-catch.md) 문서의 [비동기 메서드의 예외](../../../language-reference/keywords/try-catch.md#exceptions-in-async-methods) 섹션을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="918a0-159">For more information about how to catch exceptions in async methods, see the [Exceptions in async methods](../../../language-reference/keywords/try-catch.md#exceptions-in-async-methods) section of the [try-catch](../../../language-reference/keywords/try-catch.md) article.</span></span>

<span data-ttu-id="918a0-160">다음 예제에서는 비동기 이벤트 처리기의 동작을 보여줍니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-160">The following example shows the behavior of an async event handler.</span></span> <span data-ttu-id="918a0-161">예제 코드에서 비동기 이벤트 처리기는 주 스레드가 완료되면 이를 알려야 합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-161">In the example code, an async event handler must let the main thread know when it finishes.</span></span> <span data-ttu-id="918a0-162">그런 다음, 주 스레드는 비동기 이벤트 처리기가 프로그램을 종료하기 전에 완료될 때까지 대기할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-162">Then the main thread can wait for an async event handler to complete before exiting the program.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns3.cs":::

## <a name="generalized-async-return-types-and-valuetasktresult"></a><span data-ttu-id="918a0-163">일반화된 비동기 반환 형식 및 ValueTask\<TResult\></span><span class="sxs-lookup"><span data-stu-id="918a0-163">Generalized async return types and ValueTask\<TResult\></span></span>

<span data-ttu-id="918a0-164">C# 7.0부터 비동기 메서드는 awaiter 형식의 인스턴스를 반환하는 액세스 가능한 `GetAwaiter` 메서드가 있는 모든 형식을 반환할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-164">Starting with C# 7.0, an async method can return any type that has an accessible `GetAwaiter` method that returns an instance of an *awaiter type*.</span></span> <span data-ttu-id="918a0-165">또한 `GetAwaiter` 메서드가 반환하는 형식에는 <xref:System.Runtime.CompilerServices.AsyncMethodBuilderAttribute?displayProperty=nameWithType> 특성이 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-165">In addition, the type returned from the `GetAwaiter` method must have the <xref:System.Runtime.CompilerServices.AsyncMethodBuilderAttribute?displayProperty=nameWithType> attribute.</span></span> <span data-ttu-id="918a0-166">[작업과 유사한 반환 형식](../../../../../_csharplang/proposals/csharp-7.0/task-types.md)에 대한 기능 사양에서 자세한 내용을 알아볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-166">You can learn more in the feature spec for [Task like return types](../../../../../_csharplang/proposals/csharp-7.0/task-types.md).</span></span>

<span data-ttu-id="918a0-167">이 기능은 `await`의 피연산자에 대한 요구 사항을 설명하는 [대기 가능 식](../../../../../_csharplang/spec/expressions.md#awaitable-expressions)을 보완합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-167">This feature is the complement to [awaitable expressions](../../../../../_csharplang/spec/expressions.md#awaitable-expressions), which describes the requirements for the operand of `await`.</span></span> <span data-ttu-id="918a0-168">일반화된 비동기 반환 형식을 사용하면 컴파일러가 다른 형식을 반환하는 `async` 메서드를 생성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-168">Generalized async return types enable the compiler to generate `async` methods that return different types.</span></span> <span data-ttu-id="918a0-169">일반화된 비동기 반환 형식은 .NET 라이브러리의 성능 향상을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-169">Generalized async return types enabled performance improvements in the .NET libraries.</span></span> <span data-ttu-id="918a0-170"><xref:System.Threading.Tasks.Task> 및 <xref:System.Threading.Tasks.Task%601>는 참조 형식이므로 특히 타이트 루프에서 할당이 발생하는 경우 성능이 중요한 경로의 메모리 할당으로 인해 성능이 저하될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-170">Because <xref:System.Threading.Tasks.Task> and <xref:System.Threading.Tasks.Task%601> are reference types, memory allocation in performance-critical paths, particularly when allocations occur in tight loops, can adversely affect performance.</span></span> <span data-ttu-id="918a0-171">일반화된 반환 형식이 지원되면 추가 메모리 할당을 방지하기 위해 참조 형식 대신 간단한 값 형식을 반환할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-171">Support for generalized return types means that you can return a lightweight value type instead of a reference type to avoid additional memory allocations.</span></span>

<span data-ttu-id="918a0-172">.NET에서는 <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> 구조체를 일반화된 작업 반환 값의 간단한 구현으로 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-172">.NET provides the <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> structure as a lightweight implementation of a generalized task-returning value.</span></span> <span data-ttu-id="918a0-173"><xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> 형식을 사용하려면 `System.Threading.Tasks.Extensions` NuGet 패키지를 프로젝트에 추가해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-173">To use the <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> type, you must add the `System.Threading.Tasks.Extensions` NuGet package to your project.</span></span> <span data-ttu-id="918a0-174">다음 예제에서는 <xref:System.Threading.Tasks.ValueTask%601> 구조체를 사용하여 두 주사위 굴리기 값을 검색합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-174">The following example uses the <xref:System.Threading.Tasks.ValueTask%601> structure to retrieve the value of two dice rolls.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-valuetask.cs":::

<span data-ttu-id="918a0-175">일반화된 비동기 반환 형식 작성은 고급 시나리오이며 매우 특수한 환경에서 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-175">Writing a generalized async return type is an advanced scenario, and is targeted for use in very specific environments.</span></span> <span data-ttu-id="918a0-176">비동기 코드에 대한 대부분의 시나리오에 적용되는 `Task`, `Task<T>` 및 `ValueTask<T>` 형식을 대신 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-176">Consider using the `Task`, `Task<T>` and `ValueTask<T>` types instead, which cover most scenarios for asynchronous code.</span></span>

## <a name="async-streams-with-iasyncenumerablet"></a><span data-ttu-id="918a0-177">IAsyncEnumerable\<T\>을 사용하는 비동기 스트림</span><span class="sxs-lookup"><span data-stu-id="918a0-177">Async streams with IAsyncEnumerable\<T\></span></span>

<span data-ttu-id="918a0-178">C# 8.0부터 비동기 메서드는 <xref:System.Collections.Generic.IAsyncEnumerable%601>을 통해 표시되는 ‘비동기 스트림’을 반환할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-178">Starting with C# 8.0, an async method may return an *async stream*, represented by <xref:System.Collections.Generic.IAsyncEnumerable%601>.</span></span> <span data-ttu-id="918a0-179">비동기 스트림은 반복되는 비동기 호출을 통해 요소가 청크로 생성될 때 스트림에서 읽은 항목을 열거하는 방법을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-179">An async stream provides a way to enumerate items read from a stream when elements are generated in chunks with repeated asynchronous calls.</span></span> <span data-ttu-id="918a0-180">다음 예제에서는 비동기 스트림을 생성하는 비동기 메서드를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-180">The following example shows an async method that generates an async stream:</span></span>

:::code language="csharp" source="snippets/async-return-types/AsyncStreams.cs" id="GenerateAsyncStream":::

<span data-ttu-id="918a0-181">앞의 예제에서는 문자열의 줄을 비동기적으로 읽습니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-181">The preceding example reads lines from a string asynchronously.</span></span> <span data-ttu-id="918a0-182">각 줄을 읽은 후에는 코드가 문자열에서 각 단어를 열거합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-182">Once each line is read, the code enumerates each word in the string.</span></span> <span data-ttu-id="918a0-183">호출자는 `await foreach` 문을 사용하여 각 단어를 열거합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-183">Callers would enumerate each word using the `await foreach` statement.</span></span> <span data-ttu-id="918a0-184">메서드는 소스 문자열에서 다음 줄을 비동기적으로 읽어야 하는 경우 대기합니다.</span><span class="sxs-lookup"><span data-stu-id="918a0-184">The method awaits when it needs to asynchronously read the next line from the source string.</span></span>

## <a name="see-also"></a><span data-ttu-id="918a0-185">참조</span><span class="sxs-lookup"><span data-stu-id="918a0-185">See also</span></span>

- <xref:System.Threading.Tasks.Task.FromResult%2A>
- [<span data-ttu-id="918a0-186">완료되면 비동기 작업 처리</span><span class="sxs-lookup"><span data-stu-id="918a0-186">Process asynchronous tasks as they complete</span></span>](start-multiple-async-tasks-and-process-them-as-they-complete.md)
- [<span data-ttu-id="918a0-187">async 및 await를 사용한 비동기 프로그래밍(C#)</span><span class="sxs-lookup"><span data-stu-id="918a0-187">Asynchronous programming with async and await (C#)</span></span>](index.md)
- [<span data-ttu-id="918a0-188">async</span><span class="sxs-lookup"><span data-stu-id="918a0-188">async</span></span>](../../../language-reference/keywords/async.md)
- [<span data-ttu-id="918a0-189">await</span><span class="sxs-lookup"><span data-stu-id="918a0-189">await</span></span>](../../../language-reference/operators/await.md)
